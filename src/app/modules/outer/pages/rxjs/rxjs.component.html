<app-base-page
  [pageTitle]="'Rxjs (Reactive Extensions for JavaScript)'"
  [steps]="steps"
>
  <!--WHATSECTION-->
  <app-section
    id="'whatSection'"
    [sectionId]="'whatSection'"
    [sectionLabel]="'¿Qué es Rxjs?'"
    [sectionTitle]="'¿Qué es Rxjs?'"
    [sectionContent]="'Es una librería para programación reactiva que permite manejar flujo de datos asíncronos y eventos de forma declarativa, mediante el uso de Observables.'"
  >
    <p>RxJS te ayuda a trabajar con datos que cambian con el tiempo, como:</p>
    <ul>
      <li>Datos de APIs</li>
      <li>Respuestas HTTP</li>
      <li>Eventos del usuario</li>
      <li>Temporizadores</li>
      <li>Streams en tiempo real</li>
      <li>Gestión avanzada de concurrencia</li>
    </ul>
    <p>Todo esto lo hace usando un modelo basado en streams (flujos) y observadores.
      Su unidad fundamental es el <b>Observable</b>, que "emite" valores con el tiempo.</p>
    <div style="display: flex; justify-content: center;">
      <iframe
        width="660"
        height="415"
        [src]="safeUrl()"
        frameborder="0"
        allowfullscreen>
      </iframe>
    </div>
  </app-section>
  <!--USOSSECTION-->
  <app-section
    id="'usosSection'"
    [sectionId]="'usosSection'"
    [sectionLabel]="'Usos más comunes'"
    [sectionTitle]="'Usos más comunes'"
    [sectionContent]="''"
  >
    <p>Angular 20 depende de RxJS para muchas operaciones clave:</p>
    <h5>HTTPClient usa Observables</h5>
      <p>Cada vez que haces:</p>
      <app-sc-code-snippet
        [code]="o01observablesExample"
        language="typescript"
      >
      </app-sc-code-snippet>
      <p>Estás recibiendo un Observable.</p>
    <h5>Los formularios reactivos usan Observables</h5>
      <p>Los FormControls exponen <code>valueChanges</code>, <code>statusChanges</code>, etc.</p>
    <h5>El sistema de routing puede devolver Observables</h5>
      <p>Parámetros de ruta, eventos del router, etc.</p>
    <h5>Integración con Signals</h5>
      <p>En Angular 16+ llegaron los signals.</p>
      <p>En Angular 20, los signals coexisten con RxJS:</p>
      <ul>
        <li>signals: estado local reactivo</li>
        <li>RxJS: flujos complejos, asincronía, streams externos</li>
      </ul>
      <p>Hay utilidades modernas como:</p>
      <app-sc-code-snippet
        [code]="o02observablesExample"
        language="typescript"
      >
      </app-sc-code-snippet>
  </app-section>
  <!--CONCEPTOSPRINCIPALESSECTION-->
  <app-section
    id="'conceptosPrincipalesSection'"
    [sectionId]="'conceptosPrincipalesSection'"
    [sectionLabel]="'Conceptos Principales'"
    [sectionTitle]="'Conceptos Principales en Rxjs'"
    [sectionContent]="''"
  >
    <table class="table">
      <thead class="table-dark">
        <tr>
          <th scope="col">Concepto</th>
          <th scope="col">Descripción</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th scope="row">Observable</th>
          <td>Es la fuente del flujo de datos. Emite valores (sincrónicos o asincrónicos) a lo largo del tiempo.</td>
        </tr>
        <tr>
          <th scope="row">Observer (observador)</th>
          <td>Es el "suscriptor" que recibe los valores emitidos por el Observable.</td>
        </tr>
        <tr>
          <th scope="row">Subscription (suscripción)</th>
          <td>Representa la conexión entre el Observable y el Observer; se puede cancelar con .unsubscribe().</td>
        </tr>
        <tr>
        <th scope="row">Operators (operadores)</th>
          <td>Son funciones que permiten transformar, filtrar, combinar o manipular los datos emitidos por los Observables. Ej: map, filter, mergeMap, switchMap, etc.</td>
        </tr>
        <tr>
          <th scope="row">Subject</th>
          <td>Es un tipo especial de Observable que también puede emitir valores manualmente. Actúa como Observable + Observer a la vez.</td>
        </tr>
        <tr>
          <th scope="row">Behavoir subject</th>
          <td>Similar a Subject, pero almacena el último valor emitido, de modo que los nuevos suscriptores lo reciben inmediatamente.</td>
        </tr>
      </tbody>
    </table>
    <h5>1. Observable</h5>
    <p>Es un stream de datos:</p>
    <app-sc-code-snippet
        [code]="o03observablesExample"
        language="typescript"
      >
    </app-sc-code-snippet>
    <p>El caracter <code>$</code> es una convención para identificar Observables.</p>
    <h5>2. Observer</h5>
    <p>Es quien "escucha" al observable:</p>
    <app-sc-code-snippet
        [code]="o04observablesExample"
        language="typescript"
      >
    </app-sc-code-snippet>
    <h5>3. Operators</h5>
    <p>RxJS sobresale por sus operadores (<code>pipe</code>):</p>
    <app-sc-code-snippet
        [code]="o05observablesExample"
        language="typescript"
      >
    </app-sc-code-snippet>
    <h5>4. Subjects</h5>
    <p>Observables multicast, ideales para compartir estado o eventos.</p>
    <app-sc-code-snippet
        [code]="o06observablesExample"
        language="typescript"
      >
    </app-sc-code-snippet>
  </app-section>
  <!--EJEMPLOSECTION-->
  <app-section
    id="'ejemploSection'"
    [sectionId]="'ejemploSection'"
    [sectionLabel]="'Ejemplo'"
    [sectionTitle]="'Ejemplo'"
    [sectionContent]="''"
  >
    <h5>1. Servicio (<code>users.service.ts</code>)</h5>
    <p>Retorna un observable usando HttpClient.</p>
    <app-sc-code-snippet
      [code]="o07observablesExample"
      language="typescript"
    >
    </app-sc-code-snippet>
    <h5>2. Componente standalone (<code>users.component.ts</code>)</h5>
    <p>El componente simplemente expone el Observable.</p>
    <app-sc-code-snippet
      [code]="o08observablesExample"
      language="typescript"
    >
    </app-sc-code-snippet>

    <p>Resultado:</p>
    <ul><li *ngFor="let user of users">{{ user.name }}</li></ul>
  </app-section>
</app-base-page>
